% mnras_template.tex 
%
% LaTeX template for creating an MNRAS paper
%
% v3.0 released 14 May 2015
% (version numbers match those of mnras.cls)
%
% Copyright (C) Royal Astronomical Society 2015
% Authors:
% Keith T. Smith (Royal Astronomical Society)

% Change log
%
% v3.0 May 2015
%    Renamed to match the new package name
%    Version number matches mnras.cls
%    A few minor tweaks to wording
% v1.0 September 2013
%    Beta testing only - never publicly released
%    First version: a simple (ish) template for creating an MNRAS paper

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Basic setup. Most papers should leave these options alone.
\documentclass[fleqn,usenatbib]{mnras}

% MNRAS is set in Times font. If you don't have this installed (most LaTeX
% installations will be fine) or prefer the old Computer Modern fonts, comment
% out the following line
\usepackage{newtxtext,newtxmath}
% Depending on your LaTeX fonts installation, you might get better results with one of these:
%\usepackage{mathptmx}
%\usepackage{txfonts}

% Use vector fonts, so it zooms properly in on-screen viewing software
% Don't change these lines unless you know what you are doing
\usepackage[T1]{fontenc}

% Allow "Thomas van Noord" and "Simon de Laguarde" and alike to be sorted by "N" and "L" etc. in the bibliography.
% Write the name in the bibliography as "\VAN{Noord}{Van}{van} Noord, Thomas"
\DeclareRobustCommand{\VAN}[3]{#2}
\let\VANthebibliography\thebibliography
\def\thebibliography{\DeclareRobustCommand{\VAN}[3]{##3}\VANthebibliography}


%%%%% AUTHORS - PLACE YOUR OWN PACKAGES HERE %%%%%

% Only include extra packages if you really need them. Common packages are:
\usepackage{graphicx}	% Including figure files
% \usepackage{amsmath}	% Advanced maths commands
% \usepackage{amssymb}	% Extra maths symbols (this seems to be already defined)
\usepackage{cuted}
\setlength{\stripsep}{0ex}

%%%%% AUTHORS - PLACE YOUR OWN COMMANDS HERE %%%%%

\input{custom-commands.tex}

%%%%%%%%%%%%%%%%%%% TITLE PAGE %%%%%%%%%%%%%%%%%%%

\title[Gradus.jl]{Gradus.jl: extensible spacetime agnostic general relativistic ray-tracing through automatic differentiation}

% The list of authors, and the short list which is used in the headers.
% If you need two or more lines of authors, add an extra line using \newauthor
\author[F. J. E. Baker et al.]{
F. J. E. Baker,$^{1}$\thanks{E-mail: fergus.baker@bristol.ac.uk (FB)}
and A. J. Young$^{1}$
% Plus other contributing authors (tbc)
\\
% List of institutions
$^{1}$H. H. Wills Physics Laboratory, Tyndall Avenue, Bristol BS8 1TL, UK
}

% These dates will be filled out by the publisher
\date{Accepted XXX. Received YYY; in original form ZZZ}

% Enter the current year, for the copyright statements etc.
\pubyear{2023}

% Don't change these lines
\begin{document}
\label{firstpage}
\pagerange{\pageref{firstpage}--\pageref{lastpage}}
\maketitle

% Abstract of the paper
\begin{abstract}
	We introduce \Gradus, an open-source...
\end{abstract}

% Select between one and six entries from the list of approved keywords.
% Don't make up new ones.
\begin{keywords}
keyword1 -- keyword2 -- keyword3
\end{keywords}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%% BODY OF PAPER %%%%%%%%%%%%%%%%%%

%% INTRODUCTION
\input{gradus.introduction.tex}

%% NUMERICAL METHODS
\input{gradus.numerical-methods.tex}

\input{gradus.code.tex}

\section{Test problems}

\subsection{Integration accuracy and stability}

\todo{Angular deflection $\Delta \phi$}

Derived semi-analytically in \cite{iyer_lights_2009} (presented compactly and extended for metrics of form \eqref{eq:static_axisymmetric_metric} in Appendix \ref{appendix:deflection-angle}).


\ref{fig:deflection-angle}

\begin{figure}
	\centering
	\includegraphics[width=0.94\linewidth]{figures/deflection.iyer-hansen.pdf}
	\caption{\todo{caption, also note about the distances / effect of integrator}}
	\label{fig:deflection-angle}
\end{figure}

Since our method for integration does not use the constants of motion directly, the stability of the integrator may also be gauged by sampling invariant quantities along the trajectory. In Figure \ref{fig:constants-of-motion} is shown the value of $v_\mu v^\mu$, as in \eqref{eq:velocity_constraint}, for a number of trajectories.


\begin{figure}
	\centering
	\includegraphics[width=0.95\linewidth]{figures/stability.conservation.pdf}
	\caption{\todo{caption + better choice of integrators to compare}}
	\label{fig:dot-stability}
\end{figure}

\todo{Energy conservation, deflection problem, shadow, tests for naked-singularities}

\subsection{Analytic radiative transfer model}

Do some of that \citep{gold_verification_2020} paper with all the test problems

\ref{fig:gold-test-problems}

\begin{figure*}
	\centering
	\includegraphics[width=0.97\linewidth]{figures/radiative-transfer.gold.pdf}
	\caption{\todo{caption, also the values are not using the correct physical parameters from the Gold paper yet}}
	\label{fig:gold-test-problems}
\end{figure*}

\subsection{Emissivity curves}

\todo{Wilkins and Fabian with lamp post and moving corona, gonzalez 2017}

\subsection{Iron line profiles}

Bambi's various metrics and relline, self consistency between methods

\subsection{Lag-frequency spectra}

Ingram's code? Jiachen's code

\section{Applications}

\todo{working on spectral and timing models (Baker et al. in prep) for use in XSPEC and beyond}

\section{Conclusions}

We encourage the community to contact us with interesting problems that may be tackled using \Gradus as we are happy to assist with new applications of the code.

% Note future work, e.g., with regard to fitting, and using the code in other papers

\section*{Acknowledgements}
This work is supported by the UKRI AIMLAC CDT funded by grant EP/S023992/1.

We thank Cosimo Bambi and Jiachen Jiang for sharing their software for testing purposes. FB thanks Rosie for her debugging assistance, and Shaun Baker for invaluable software design discussions.
\todo{acknowledge Makie for plots}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Data Availability}

No new data or analyses have been created for this work. The code to reproduce this paper and all figures therein is freely available under MIT license:
\url{https://github.com/fjebaker/gradus-paper}


% The inclusion of a Data Availability Statement is a requirement for articles published in MNRAS. Data Availability Statements provide a standardised format for readers to understand the availability of data underlying the research results described in the article. The statement may refer to original data generated in the course of the study or to third-party data analysed in the article. The statement should describe and provide means of access, where possible, by linking to the data or providing the required accession numbers for the relevant databases or DOIs.

%%%%%%%%%%%%%%%%%%%% REFERENCES %%%%%%%%%%%%%%%%%%

% The best way to enter references is to use BibTeX:

\bibliographystyle{mnras}
\bibliography{citations} % if your bibtex file is called example.bib


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%% APPENDICES %%%%%%%%%%%%%%%%%%%%%

\appendix

\input{gradus.appendix.gram-schmidt.tex}
\input{gradus.appendix.circular-orbits.tex}
\input{gradus.appendix.deflection-angle.tex}

% \section{Some extra material}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Don't change these lines
\bsp	% typesetting comment
\label{lastpage}
\end{document}

% End of mnras_template.tex
